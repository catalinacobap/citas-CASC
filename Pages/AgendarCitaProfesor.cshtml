@page
@model CitasEnfermeria.Pages.AgendarCitaProfesorModel
@{
    ViewData["Title"] = "Agendar Cita (Profesor)";
}

<h1>Agendar Cita</h1>

<!-- Modal estilo Apple -->
<div id="appleModal" class="apple-modal" style="display:none;">
    <div class="apple-modal-content">
        <span id="appleModalClose" class="apple-modal-close">&times;</span>
        <div id="appleModalMessage"></div>
    </div>
</div>

<form method="post">
    <div>
        <label>Horario disponible:</label>
        <select asp-for="HorarioSeleccionadoId" class="form-select">
            @foreach (var horario in Model.HorariosDisponibles)
            {
                <option value="@horario.Id">
                    @horario.Fecha.ToShortDateString() @horario.Hora
                </option>
            }
        </select>
    </div>
    <br />
    <button type="submit" class="btn btn-primary">Agendar</button>
</form>

<!-- Botón para agendar emergencia (solo visible para profesores) -->
@if (Model.EsProfesor)
{
    <button id="btnEmergencia" class="btn btn-danger mt-4">Agendar Emergencia</button>
}

<!-- Modal de búsqueda de emergencia (se llenará luego) -->
<div id="modalEmergencia" class="apple-modal" style="display:none;">
    <div class="apple-modal-content">
        <span id="closeEmergencia" class="apple-modal-close">&times;</span>
        <h5>Buscar estudiante para emergencia</h5>
        <input type="text" id="busquedaEstudiante" class="form-control mb-2" placeholder="Escribe el nombre..." autocomplete="off" />
        <ul id="listaEstudiantes" class="list-group mb-2"></ul>
        <div id="emergenciaConfirmacion"></div>
    </div>
</div>

@section Scripts {
<script>
    // Modal Apple general
    function showAppleModal(message) {
        document.getElementById('appleModalMessage').innerHTML = message;
        document.getElementById('appleModal').style.display = 'block';
    }
    document.getElementById('appleModalClose').onclick = function() {
        document.getElementById('appleModal').style.display = 'none';
    };
    window.onclick = function(event) {
        if (event.target == document.getElementById('appleModal')) {
            document.getElementById('appleModal').style.display = 'none';
        }
    };
    @if (Model.ErrorCita != null)
    {
        <text>showAppleModal('@Model.ErrorCita');</text>
    }
    @if (TempData["Mensaje"] != null)
    {
        <text>showAppleModal('@TempData["Mensaje"]');</text>
    }
    // Emergencia modal (lógica se agregará luego)
</script>
} 